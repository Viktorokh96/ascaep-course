\documentclass[utf8x,14pt, coursreport]{G7-32}
% masterthes -- диссертация магистра
% diploma -- дипломная работа инженера
% bachelor -- квалификационная работа бакалавра
% coursreport -- курсовая работа
% projreport -- курсовой проект по дисциплине
% appreport -- отчет о прикладных научных исследованиях
% scireport -- отчет о научно-исследовательской работе
% report -- отчёт (по практике)
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{epstopdf}
%\usepackage{bookmark}
\usepackage{titletoc}

\usepackage{verbatim}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{listingsutf8}

\lstloadlanguages{C, [ANSI]C++}

\usepackage[colorlinks=true, citecolor=blue, bookmarksopen=true]{hyperref}

% additional packages
%\usepackage{subcaption}
\usepackage{float}
%\usepackage{rotating}
%\usepackage{multirow}
%\usepackage{mdwlist}
\usepackage{textcase}
\usepackage{array}
\usepackage{graphicx}

\usepackage{color}

\definecolor{greencomments}{rgb}{0, 0.3, 0}
\definecolor{redstrings}{rgb}{0.8, 0.0, 0}
\definecolor{orangekeys}{rgb}{0.0, 0.2, 0.8}

% Определим свой цветовой стиль для листинга программ
\lstdefinestyle{cstyle}{
	commentstyle=\color{greencomments},
	stringstyle=\color{redstrings},
	basicstyle=\footnotesize,
	keywordstyle=\color{orangekeys},
	extendedchars=true,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
	captionpos=t,
	basicstyle=\ttfamily,
	tabsize=2
}

% Устновка текущего стиля листинга
\lstset{style=cstyle}	

% avsolov: 2014-11-13: Не используйте \url{} внутри BIB!
% Это приводит к ошибке: TeX capacity exceeded, sorry [input stack size=5000]
% И вообще в отчете по ГОСТ нет необходимости в тегах \url{}.

\TableInChapter % таблицы будут нумероваться в пределах раздела
\PicInChapter   % рисунки будут нумероваться в пределах раздела
\EqInChapter    % формулы будут нумероваться в пределах раздела

% Определяем заголовки для титульной страницы
%% Полное название организации
\NirOrgLongName{{\small Министерство образования и науки Российской Федерации\\
 Федеральное государственное бюджетное образовательное учреждение высшего образования}\\ <<Петрозаводский государственный университет>>\\
Физико-технический институт\\
Кафедра физики твердого тела}

\NirAuthor{\signfield{Автор работы:\newline студент группы 21312}{В.\,Б.\,Охотников}}

\NirSupervisor{\signfield{Научный руководитель:\newline канд.\,физ.-мат.\,наук, доцент}{И.\,В.\,Климов}}

%\NirYear{2015} %% год отчёта; если закомментировано, ставится текущий год
\NirTown{Петрозаводск} %% город, в котором написан отчёт


%%%%%%%<------------- НАЧАЛО ДОКУМЕНТА

\begin{document}
\usefont{T2A}{ftm}{m}{} %%% Использование шрифтов Т2 для возможности скопировать текст из PDF-файлов.

\frontmatter %%% <-- это выключает нумерацию ВСЕГО; здесь начинаются ненумерованные главы типа Исполнители, Обозначения и прочее

% \NirTitle{ПРАВИЛА ОФОРМЛЕНИЯ ВЫПУСКНЫХ КВАЛИФИКАЦИОННЫХ РАБОТ}{09.04.01 ``Информатика и вычислительная техника''} %%% Название работы, доп.параметр - направление подготовки; <-- генерация титульного листа

\NirTitle{РАЗРАБОТКА СИСТЕМЫ МОНИТОРИНГА И ПРОГНОЗИРОВАНИЯ ПОТРЕБЛЕНИЯ ЭЛЕКТРОЭНЕРГИИ В ЭЛЕКТРИЧЕСКИХ СЕТЯХ}{} %%% Название работы, доп. параметр -- вид отчета <-- генерация титульного листа

\Referat %% Реферат отчёта, не более 1 страницы

Работа содержит \totalpages{}~с., \totalfigures{}~рис., \totaltables{}~табл., \totalbibs{}~источника.

Ключевые слова:
\begin{itemize}
\item АСКУЭ
\item Клиент
\item Сервер
\item УСПД
\item КУСД
\item USART
\item SPI
\item CAN
\item Ethernet
\end{itemize}

\tableofcontents

% Если требуется раздел "Обозначения и сокращения"
\Abbreviations

\begin{description}
\item[ПО] Программное обеспечение.
\item[OC] Операционная система.
\item[МК] Микроконтроллер.
\item[УСПД] Устройство сбора и передачи данных.
\item[КУСД] Контроллер удаленного сбора данных.
\item[ИИК] Информационно-измерительный канал.
\item[ИВК] Информационно-вычислительный комплекс.
\item[Сервер] Обслуживающее устройство в системах автоматической обработки информации.
\item[Клиент] КУСД, обрабатывающий и передающий данные на сервер с различных датчиков.
\end{description}


% Введение
\Introduction
Автоматизация сбора, обработки и выдачи информации в настоящее время широко используется в самых различных сферах человеческой деятельности. Можно выделить одну из таких целей автоматизации, как повышение качества управления объектами и процессами за счет оперативного предоставления операторам информации в требуемые сроки и форме, удобной для анализа. Также автоматизация способствует уменьшению влияния человеческого фактора и, как следствие, снижение вероятности аварий. Электрические сети ~--- один из объектов внедрения автоматизированных систем.

В связи с тем, что все процессы, возникающие в электросетях, протекают мгновенно и могут быть только зафиксированы, но не измерены напрямую, задача определения показателей качества электрической энергии не является простой. Расcчитывать и выдавать объективное заключение необходимо только по статистически обработанным результатам. Очевидно, что для точного определения показателей качества электрической энергии необходимо непрерывно осуществлять наблюдение, выполнять большой объем измерений, причём с очень высокой скоростью, а также параллельно выполнять математическую и статистическую обработку получаемых данных.\cite{qualitymonitor}

Целью данной работы является разработка контроллера, способного получать данные о состоянии электрических сетей с последующей передачей на удаленный сервер.

%---------------начало основной части-------------------------%

\mainmatter %% <-- это включает нумерацию глав и секций в документе ниже

\include{overview}


%\include{specification} % Скорее всего лишнее


\include{components}

\include{realization}

%-------------------конец основной части------------------------------------%

\backmatter %% Здесь заканчивается нумерованная часть документа и начинаются заключение и ссылки


\Conclusion

Был проведен обзор системы АСКУЭ. Описана клиентская часть данной системы. Описаны технологии которые могут активно применятся при разработке КУСД, обеспечивая гибкость, надежность и расширяемость данной реализации.

Написано тестовое ПО для проверки и отладки некоторых сетевых возможностей КУСД. Рассмотрены различные способы конфигурирования сетевых настроек контроллера. Планируется использование беспроводных технологии передачи данных в будущем, а также увеличение количества поддерживаемых сетевых протоколов.


%% Альтернативное оформление библиографического списка:
\begin{thebibliography}{99}

\bibitem{qualitymonitor} Монитор качества электроэнергии. [Электронный ресурс] /  Режим доступа: http://fidercom.ru/pribory-uchyota-elektroenergii/monitoring-kachestva-\\elektroenergii.html. --- (Дата последнего обращения: 13.05.2017).

\bibitem{ascaepinfo} Автоматизированная система коммерческого учета электроэнергии (АСКУЭ). / Н.М. Гришагина, Э.Г Гарайшина. // Вестник Казанского технологического университета. --- 2013. --- \No~12. --- С.~297-299.

\bibitem{ethernetinfo} Что такое Ethernet / Всё о компьютерных сетях. [Электронный ресурс] ~--- 2010. ~--- Режим доступа: http://loknet.ru/teoriya/chto-takoe-ethernet.html --- (дата последнего обращения: 13.05.2017)

\bibitem{ethersite2} Технология Ethernet. Обзор технологии. Разновидности Ethernet. Стандарты Ethernet. / Инсотел - Поставки сетевого и серверного оборудования. [Электронный ресурс] ~--- URL: http://www.insotel.ru/article.php?id=240 --- (дата последнего обращения: 13.05.2017)

\bibitem{gsmwiki} GSM / Википедия. [Электронный ресурс] ~--- Режим доступа: https://ru.wikipedia.org/wiki/GSM --- 2017. --- (дата последнего обращения: 13.05.2017)

\bibitem{gsmchar} Общая характеристика стандарта GSM [Электронный ресурс] ~--- Режим доступа: http://life-prog.ru/2\_77781\_obshchaya-harakteristika-standarta-GSM.html  --- 2015. --- (дата последнего обращения: 13.05.2017)

\bibitem{wifistandarts} Wi-Fi, Стандарты [Электронный ресурс] ~--- Режим доступа: http://wi-life.ru/texnologii/wi-fi/wi-fi-standarty --- (дата последнего обращения: 13.05.2017)

\bibitem{mercinfo1} Краткое описание устройства и принципа действия счетчика меркурий 230. [Электронный ресурс] ~--- Режим доступа: http://libdocs.ru/docs/141100/index-429.html --- (дата последнего обращения: 13.05.2017)

\bibitem{mercinfo2} СЧЁТЧИКИ ЭЛЕКТРИЧЕСКОЙ ЭНЕРГИИ 
трёхфазные, активно/реактивные, многофункциональные. [Электронный ресурс] ~--- Режим доступа: http://www.incotexcom.ru/m230art.htm --- (дата последнего обращения: 13.05.2017)

\bibitem{protocols} Что такое сетевой протокол? / Компания АВК [Электронный ресурс] ~--- Режим доступа: https://www.avk-company.ru/articles/25/ --- (дата последнего обращения: 13.05.2017)

\bibitem{tcpip} Стек протоколов TCP/IP / CITFORUM. Введение в IP сети. [Электронный ресурс] ~--- Режим доступа: http://citforum.ru/nets/ip/glava\_2.shtml --- (дата последнего обращения: 13.05.2017)

\bibitem{arp} ARP [Электронный ресурс] ~--- Режим доступа: http://xgu.ru/wiki/ARP --- (дата последнего обращения: 13.05.2017)

\bibitem{arpcitforum}  Протокол ARP  / CITFORUM. Введение в IP сети. [Электронный ресурс] ~--- Режим доступа: http://citforum.ru/nets/tcpip/arp.shtml --- (дата последнего обращения: 13.05.2017)

\bibitem{usart1} Универсальный синхронно-асинхронный приемопередатчик USART / [Электронный ресурс] ~--- Режим доступа: https://prog-cpp.ru/micro-usart/ --- (дата последнего обращения: 13.05.2017)

\bibitem{spiinterface} Последовательный интерфейс SPI [Электронный ресурс] ~--- Режим доступа: http://www.gaw.ru/html.cgi/txt/interface/spi/index.htm --- (дата последнего обращения: 19.05.2017)

\bibitem{atmegainfo} ATmega328/P Datasheet / Atmel [Электронный ресурс] ~--- Режим доступа: http://www.atmel.com/Images/Atmel-42735-8-bit-AVR-Micro\-controller-\-AT\-me\-ga\-328-328P\_Datasheet.pdf --- (дата последнего обращения: 14.05.2017)

\bibitem{arduino} Arudino Uno / Амперка [Электронный ресурс] ~--- Режим доступа: http://amperka.ru/product/arduino-uno --- (дата последнего обращения: 14.05.2017)

\bibitem{enc28j60datasheet} ENC28J60 Datasheet / Microchip  [Электронный ресурс] ~--- Режим доступа: http://ww1.microchip.com/downloads/en/devicedoc/39662a.pdf --- (дата последнего обращения: 14.05.2017)

\bibitem{avrtoolchain} The AVR GCC Toolchain / Sourceforge [Электронный ресурс] ~--- Режим доступа: http://avr-eclipse.sourceforge.net/wiki/index.php/The\_AVR\_GCC\_Toolchain --- (дата последнего обращения: 14.05.2017)

\bibitem{voltageregulator} AMS1117 / Advanced Monolithic Systems [Электронный ресурс] ~--- http://www.advanced-monolithic.com/pdf/ds1117.pdf --- (дата последнего обращения: 19.05.2017)

\bibitem{ethernetworking} Подключение микроконтроллера к локальной сети: работаем с ENC28J60  / EasyElectrionics [Электронный ресурс] ~--- Режим доступа: http://we.easyelectronics.ru/electro-and-pc/podklyuchenie-mikrok\-ont\-ro\-lle\-ra-k-lo\-ka\-lnoy-se\-ti-ra\-botaem-s-enc28j60.html --- (дата последнего обращения: 19.05.2017)

\end{thebibliography}

%% Оформление библиографического списка при помощи BibTeX:
%\bibliographystyle{ugost2003} % <-- avsolov: это стандартный стиль
%\bibliography{research_report} % подключаем файл research_report.bib

\appendix

\chapter{Исходные тексты программ}

% range output - [firstline=*num*, lastline=*num*] or [linerange={(first1)-(last1), (first2)-(last2), ...}
{\small{\lstinputlisting[language=C, caption=main.c, inputencoding=cp1251]{./src/main.c}}}

%-------------------------------------------------------------->> КОНЕЦ

\end{document}
